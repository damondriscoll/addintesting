<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides/1.0" xsi:type="MailApp">
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:type="MailApp">
  <Id>36a4d8e0-daf5-4d0e-a44b-7a18aa4c52b9</Id>
  <Version>1.0.0.0</Version>
  <ProviderName>PerrKnight</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>
  <DisplayName DefaultValue="Forward as Attachment Add-in"/>
  <Description DefaultValue="Forwards the currently selected email as an attachment to a specific address."/>
  <SupportUrl DefaultValue="google.com"/>
  <AppDomains>
    <AppDomain>https://www.github.com</AppDomain>
  </AppDomains>

  <!-- Permissions needed to read current item and create new mail with attachments -->
  <Permissions>ReadWriteMailbox</Permissions>

  <!-- Host specification (supports Outlook) -->
  <Hosts>
    <Host Name="Mailbox"/>
  </Hosts>

  <Requirements>
    <Sets>
      <Set Name="Mailbox" MinVersion="1.1"/>
    </Sets>
  </Requirements>

  <DefaultSettings>
    <!-- We remove any SourceLocation reference (like home.html) -->
    
    <!-- Define the button on the message read surface -->
    <ExtensionPoint xsi:type="MessageReadCommandSurface">
      <OfficeTab id="TabDefault">
        <Group id="CustomButtonGroup">
          <!-- Minimal group; no icons needed -->
          <Control xsi:type="Button" id="ForwardAsAttachmentButton">
            <Label resid="buttonLabel"/>
            <Supertip>
              <Title resid="buttonLabel"/>
              <Description resid="buttonDescription"/>
            </Supertip>
            <!-- When the user clicks the button, it calls our function -->
            <Action xsi:type="ExecuteFunction">
              <FunctionName>forwardAsAttachment</FunctionName>
            </Action>
          </Control>
        </Group>
      </OfficeTab>
    </ExtensionPoint>

    <!-- Minimal resource strings -->
    <Resources>
      <bt:ShortStrings>
        <bt:String id="buttonLabel" DefaultValue="Forward as Attachment"/>
      </bt:ShortStrings>
      <bt:LongStrings>
        <bt:String id="buttonDescription" DefaultValue="Forward this email (as an attachment) to a specific address."/>
      </bt:LongStrings>
    </Resources>
  </DefaultSettings>

  <!-- VersionOverrides for add-in commands -->
  <VersionOverrides 
      xsi:type="VersionOverrides" 
      xmlns="http://schemas.microsoft.com/office/mailappversionoverrides/1.0"
      Version="1.0">
    <Hosts>
      <Host xsi:type="MailHost">
        <FunctionFile resid="functionFile"/>
      </Host>
    </Hosts>

    <!-- Point to our function-file.html -->
    <Resources>
      <FunctionFile 
        resid="functionFile" 
        src="https://raw.githubusercontent.com/damondriscoll/addintesting/refs/heads/main/addin.html" />
    </Resources>

    <!-- Basic mailbox requirement set -->
    <Requirements>
      <Sets DefaultMinVersion="1.1">
        <Set Name="Mailbox"/>
      </Sets>
    </Requirements>
  </VersionOverrides>
</OfficeApp>